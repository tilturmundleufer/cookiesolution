(()=>{const e="1.0.0",t={showOnlyInRegions:["EU","UK","CH"],geoEndpoint:"https://ipapi.co/json/",euCountryCodes:["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","IS","LI","NO"],ukCodes:["GB"],chCodes:["CH"],categories:["essential","analytics","functional","marketing"],cookie:{name:"cs_consent",days:365,domain:function(e){try{const t=e.split(".");if(t.length<=2)return e;const n=["co.uk","ac.uk","gov.uk","com.au","com.br"],o=t.slice(-2).join("."),a=t.slice(-3).join(".");return n.includes(o)?a:o}catch(t){return e}}(window.location.hostname),sameSite:"Lax",secure:!0},storageKey:"cs_consent_log",webhookUrl:"https://t-l-consent-handling.vercel.app/api/consentHandler",consentLogRetentionDays:1095,i18n:{de:{banner_title:"Cookies & Datenschutz",banner_desc:"Wir verwenden Cookies, um unsere Website zu betreiben und zu verbessern. Sie können Ihre Auswahl anpassen.",banner_prefs:"Einstellungen",btn_accept:"Alle akzeptieren",btn_reject:"Nur Essenzielle",btn_save:"Auswahl speichern",prefs_title:"Cookie-Einstellungen",prefs_intro:"Wählen Sie aus, welche Kategorien wir verwenden dürfen. Essenzielle Cookies sind immer aktiv.",cat_essential:"Essenziell",cat_essential_desc:"Erforderlich für die Grundfunktionen der Website.",cat_analytics:"Analytics",cat_analytics_desc:"Hilft uns, die Leistung zu messen (z. B. GA4, Hotjar).",cat_functional:"Funktional",cat_functional_desc:"Komfortfunktionen & eingebettete Medien (z. B. YouTube, Karten).",cat_marketing:"Marketing",cat_marketing_desc:"Personalisierte Werbung & Tracking durch Dritte.",manage_label:"Cookie-Einstellungen",embed_blocked:"Dieses eingebettete Medium ist blockiert, bis Sie <em>Funktional</em> erlauben.",enable_functional:"Funktionale Cookies erlauben"},en:{banner_title:"Cookies & Privacy",banner_desc:"We use cookies to operate and improve our site. You can adjust your choices.",banner_prefs:"Preferences",btn_accept:"Accept all",btn_reject:"Essentials only",btn_save:"Save selection",prefs_title:"Cookie settings",prefs_intro:"Choose which categories we may use. Essential cookies are always on.",cat_essential:"Essential",cat_essential_desc:"Required for basic site functionality.",cat_analytics:"Analytics",cat_analytics_desc:"Helps us measure performance (e.g. GA4, Hotjar).",cat_functional:"Functional",cat_functional_desc:"Convenience & embedded media (e.g. YouTube, maps).",cat_marketing:"Marketing",cat_marketing_desc:"Personalised advertising & third‑party tracking.",manage_label:"Cookie settings",embed_blocked:"This embedded media is blocked until you allow <em>Functional</em>.",enable_functional:"Allow functional cookies"}}};function n(e,t,n,o,a=!0,i="Lax"){const c=new Date;c.setTime(c.getTime()+24*n*60*60*1e3);const r=[`${e}=${encodeURIComponent(t)}`,`expires=${c.toUTCString()}`,"path=/",o?`domain=.${o}`:"",a?"Secure":"",`SameSite=${i}`].filter(Boolean);document.cookie=r.join("; ")}function o(e,t=document){return t.querySelector(e)}function a(e,t=document){return Array.from(t.querySelectorAll(e))}function i(){try{const e="cs_consent_uid",t=localStorage.getItem(e);if(t)return t;const n=crypto&&"function"==typeof crypto.randomUUID?crypto.randomUUID():"uid_"+Math.random().toString(16).slice(2)+Date.now().toString(16);return localStorage.setItem(e,n),n}catch(e){return"uid_"+Math.random().toString(16).slice(2)+Date.now().toString(16)}}function c(n,o,a){const c=function(){const e=document.currentScript||document.querySelector('script[src*="cookie-solution"]');return e?.getAttribute("data-cs-webhook")||t.webhookUrl||null}();if(!c)return;const s=m||{},l={ts:n.ts||Date.now(),action:o,consent:{essential:!0,analytics:!!n.analytics,functional:!!n.functional,marketing:!!n.marketing},version:e,region:n.region||s.region||"unknown",language:r(),consent_uid:n.consent_uid||i(),gpc:!0===navigator.globalPrivacyControl,source:a||null,domain:window.location.hostname,country_code:s.country_code||null,country_name:s.country_name||null};fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l),keepalive:!0}).catch(e=>{"undefined"!=typeof console&&console.warn&&console.warn("Cookie consent webhook error:",e)})}function r(){const e=document.documentElement.lang||"",t=navigator.language||navigator.userLanguage||"";return/^de/i.test(t||e)?"de":"en"}const s={version:e,essential:!0,analytics:!1,functional:!1,marketing:!1,ts:Date.now(),region:"unknown",consent_uid:null};function l(){try{return JSON.parse((e=t.cookie.name,document.cookie.split("; ").reduce((t,n)=>{const[o,...a]=n.split("=");return o===e&&(t=decodeURIComponent(a.join("="))),t},"")))||null}catch(e){return null}var e}function u(){dataLayer.push(arguments)}function d(e){const t=!0===navigator.globalPrivacyControl,n=e.analytics&&!t,o=e.marketing&&!t;u("consent","update",{ad_storage:o?"granted":"denied",ad_user_data:o?"granted":"denied",ad_personalization:o?"granted":"denied",analytics_storage:n?"granted":"denied",functionality_storage:e.functional?"granted":"denied",security_storage:"granted"})}function g(e){t.categories.forEach(t=>{"essential"!==t&&e[t]&&(a(`script[type="text/plain"][data-category="${t}"]`).forEach(e=>{const t=document.createElement("script");for(const{name:n,value:o}of Array.from(e.attributes))"type"!==n&&"data-category"!==n&&t.setAttribute(n,o);e.src?t.src=e.src:t.text=e.text||e.innerHTML,e.parentNode.replaceChild(t,e)}),a(`iframe[data-category="${t}"][data-blocked="true"]`).forEach(e=>{const t=e.getAttribute("data-src");t&&(e.setAttribute("src",t),e.removeAttribute("data-blocked"));const n=e.closest(".cs-embed-wrapper");if(n){const e=n.querySelector(".cs-embed-placeholder");e&&e.remove()}}))})}function f(){t.categories.forEach(e=>{"essential"!==e&&a(`iframe[data-category="${e}"]:not([data-prepared="1"])`).forEach(t=>{t.setAttribute("data-prepared","1");const n=E()[e],o=t.getAttribute("src");if(!n&&o){t.setAttribute("data-src",o),t.setAttribute("data-blocked","true"),t.removeAttribute("src");const e=document.createElement("div");e.className="cs-embed-wrapper",t.parentNode.insertBefore(e,t),e.appendChild(t);const n=document.getElementById("cs-embed-placeholder-template");if(n){const t=n.content.cloneNode(!0);e.appendChild(t)}}})})}window.dataLayer=window.dataLayer||[],u("consent","default",{ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",analytics_storage:"denied",functionality_storage:"denied",security_storage:"granted"});let m=null;function p(e){return e?t.euCountryCodes.includes(e)?"EU":t.ukCodes.includes(e)?"UK":t.chCodes.includes(e)?"CH":"OTHER":"unknown"}async function y(){if(m)return m;if(!t.geoEndpoint)return null;try{const e=await fetch(t.geoEndpoint,{credentials:"omit"}),n=await e.json(),o=(n.country_code||n.country||"").toUpperCase();return m={country_code:o||null,country_name:n.country_name||null,region:p(o)},s.region=m.region,m}catch(e){return null}}function _(){o("#cs-prefs").hidden=!1,v(E()),function(e){const t=o(e);if(!t)return;h=document.activeElement;const n=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),a=n[0],i=n[n.length-1];t.addEventListener("keydown",function(e){"Tab"===e.key&&(e.shiftKey&&document.activeElement===a?(e.preventDefault(),i.focus()):e.shiftKey||document.activeElement!==i||(e.preventDefault(),a.focus())),"Escape"===e.key&&k()}),setTimeout(()=>{a&&a.focus()},0)}("#cs-prefs")}function k(){o("#cs-prefs").hidden=!0,h&&h.focus()}function b(){const e=o("#cs-manage");e&&(e.hidden=!1)}let h=null;let w=null;function E(){return w||s}function v(e){document.querySelectorAll("[data-cs-cat]").forEach(t=>{const n=t.getAttribute("data-cs-cat");"essential"!==n&&(t.checked=!!e[n])})}function S(e,a,i){const r=E(),s=t.categories.some(t=>"essential"!==t&&(!0===r[t]&&!1===e[t]));w=e,function(e,o,a){const i=JSON.stringify(e);n(t.cookie.name,i,t.cookie.days,t.cookie.domain,t.cookie.secure,t.cookie.sameSite);try{const n=JSON.parse(localStorage.getItem(t.storageKey)||"[]");n.push({ts:Date.now(),action:o||"unknown",state:e});const a=Date.now()-24*t.consentLogRetentionDays*60*60*1e3,i=n.filter(e=>e.ts>=a);localStorage.setItem(t.storageKey,JSON.stringify(i))}catch(e){}o&&c(e,o,a)}(e,a,i),d(e),g(e),f(),v(e),o("#cs-banner").hidden=!0,k(),b(),s&&window.location.reload()}var C;C=async()=>{!function(){const e=t.i18n[r()];a("[data-i18n]").forEach(t=>{const n=t.getAttribute("data-i18n");e[n]&&(t.innerHTML=e[n])})}(),s.consent_uid=i(),y(),document.body.addEventListener("click",e=>{const n=e.target.closest("[data-cs]");if(!n)return;const o=n.getAttribute("data-cs");if("open-prefs"===o&&_(),"close"===o&&k(),"accept"===o&&S({...s,analytics:!0,functional:!0,marketing:!0,ts:Date.now()},"accept_all","banner"),"reject"===o&&S({...s,analytics:!1,functional:!1,marketing:!1,ts:Date.now()},"reject_all","banner"),"save-selection"===o){const e=E(),n={...s,region:e.region,ts:Date.now()};t.categories.forEach(e=>{if("essential"===e)return;const t=document.querySelector(`[data-cs-cat="${e}"]`);n[e]=!!t&&!!t.checked}),S(n,"save_selection","prefs")}"enable-functional"===o&&S({...E(),functional:!0,ts:Date.now()},"save_selection","embed_prompt")});const e=l();if(e){w={...s,...e};const o=await y();if(o&&(s.region=o.region),o&&("unknown"===e.region||!e.region)){const a={...e,region:o.region};w={...s,...a},function(e){const o=JSON.stringify(e);n(t.cookie.name,o,t.cookie.days,t.cookie.domain,t.cookie.secure,t.cookie.sameSite)}(a)}return d(w),g(w),f(),void b()}await async function(){if(!t.geoEndpoint)return!0;const e=await y();return!e||"OTHER"!==e.region}()&&(o("#cs-banner").hidden=!1),f()},"loading"!==document.readyState?C():document.addEventListener("DOMContentLoaded",C)})();